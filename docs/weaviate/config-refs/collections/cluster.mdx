---
title: Cluster configuration
description: Reference for sharding and replication parameters in Weaviate.
---

import RaftRFChangeWarning from "/_includes/1-25-replication-factor.mdx";

For multi-node Weaviate deployments, you can configure how data is distributed and replicated across the cluster. These settings are crucial for scalability and fault tolerance.

:::note Why configure sharding and replication?

- **Sharding** distributes your data across multiple nodes, allowing your dataset to scale beyond the resources of a single machine.
- **Replication** creates copies of your data on different nodes, ensuring high availability and data safety in case a node fails.

:::

---

### Sharding

Sharding is configured via the `shardingConfig` object in the collection definition. These parameters are immutable and cannot be changed after the collection is created.

| Parameter             | Type    | Description                                                                                                                                                                         | Default         |
| :-------------------- | :------ | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------- |
| `desiredCount`        | Integer | **(Optional, Immutable)** The desired number of physical shards for the collection. If this value is larger than the number of cluster nodes, some nodes will host multiple shards. | Number of nodes |
| `virtualPerPhysical`  | Integer | **(Optional, Immutable)** The number of virtual shards per physical shard. Virtual shards aid in reducing data movement during rebalancing.                                         | `128`           |
| `strategy`            | String  | **(Optional, Immutable)** The strategy for determining which shard an object belongs to. Only `"hash"` is currently supported. The hash is based on the `key` property.             | `"hash"`        |
| `key`                 | String  | **(Optional, Immutable)** The property used for hashing to determine the target shard. Currently, only the object's internal UUID (`_id`) can be used.                              | `"_id"`         |
| `function`            | String  | **(Optional, Immutable)** The hashing function used on the `key`. Only `"murmur3"` is supported, which creates a 64-bit hash, making collisions highly unlikely.                    | `"murmur3"`     |
| `actualCount`         | Integer | **(Read-only)** The actual number of physical shards created. This typically matches `desiredCount` unless an issue occurred during creation.                                       | `1`             |
| `desiredVirtualCount` | Integer | **(Read-only)** A calculated value representing `desiredCount * virtualPerPhysical`.                                                                                                | `128`           |
| `actualVirtualCount`  | Integer | **(Read-only)** The actual number of virtual shards that were created.                                                                                                              | `128`           |

<details>
  <summary>Example sharding configuration</summary>

An example of a complete `shardingConfig` object:

```json
  "shardingConfig": {
    "virtualPerPhysical": 128,
    "desiredCount": 1,           // defaults to the amount of Weaviate nodes in the cluster
    "actualCount": 1,
    "desiredVirtualCount": 128,
    "actualVirtualCount": 128,
    "key": "_id",
    "strategy": "hash",
    "function": "murmur3"
  }
```

</details>

---

### Replication

<RaftRFChangeWarning />

[Replication](/deploy/configuration/replication.md) configurations can be set using the definition, through the `replicationConfig` parameter.

The `factor` parameter sets the number of copies of to be stored for objects in this collection.

| Parameter | Type    | Default | Mutable | Description                                                                                                     |
| :-------- | :------ | :------ | :------ | :-------------------------------------------------------------------------------------------------------------- |
| `factor`  | Integer | `1`     | Yes     | The number of copies (replicas) to maintain for each shard. A factor of `3` means one primary and two replicas. |

<details>
  <summary>Example replication configuration</summary>

An example of a complete `replicationConfig` object:

```json
{
  "class": "Article",
  "vectorizer": "text2vec-openai",
  // highlight-start
  "replicationConfig": {
    "factor": 3
  }
  // highlight-end
}
```

</details>

## Further resources

- [How-to: Replication](/docs/deploy/configuration/replication.md)

## Questions and feedback

import DocsFeedback from "/_includes/docs-feedback.mdx";

<DocsFeedback />
